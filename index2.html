<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Calculator</title>
    <style>
      /* Calculator Build a web calculator, that supports the basic operations of add,
      remove, multiply and divide. In addition, support resetting the current state,
      as well as a decimal point button. When you feel ready, you can validate your
      solution using any collaborative HTML/CSS renderer, such as this one. */
    </style>
    <style>
      /* --------------------
      Add your styling here
      -------------------- */
      .flex {
        display: flex;
      }
      .box {
        width: 100px;
        height: 100px;
        border: 1px solid black;
      }
    </style>
  </head>
  <body>
    <div class="calculator">
      <!----------------------
    Add your markup here    
    ------------------------>
      <div class="user-display">
        <label for="user-input"></label>
        <input type="text" id="user-input" />
      </div>
      <div class="keypad">
        <div class="numbers">
          <button class="button number 1" value="1">1</button>
          <button class="button number 2" value="2">2</button>
          <button class="button number 3" value="3">3</button>
          <button class="button number 4" value="4">4</button>
          <button class="button number 5" value="5">5</button>
          <button class="button number 6" value="6">6</button>
          <button class="button number 7" value="7">7</button>
          <button class="button number 8" value="8">8</button>
          <button class="button number 9" value="9">9</button>
          <button class="button number 0" value="0">0</button>
          <button class="button number decmial" value=".">.</button>
        </div>
        <div class="operators">
          <button class="button operator clear" value="CE">CE</button>
          <button class="button operator multiply" value="*">X</button>
          <button class="button operator divide" value="/">/</button>
          <button class="button operator subtract" value="-">-</button>
          <button class="button operator add" value="+">+</button>
          <button class="button operator equals" value="=">=</button>
        </div>
      </div>
    </div>
    <script>
      //DOM elements
      const output = document.getElementById("user-input");
      output.value = 0;
      const numbers = document.querySelectorAll(".number");
      const numbersArr = Array(...numbers);
      const operators = document.querySelectorAll(".operator");
      const operatorsArr = Array(...operators);

      let equation = []; // running equation
      let displayValue = []; //current value
      let dotboolean = false; // boolean to check if current value has a decimal point
      let operatorboolean = false;
      let finalResult = "0"; //

      // function run each time a button is pressed
      const updateOutputNum = (num) => {
        console.log(num, equation, "num");
        if (num != ".") {
          equation.push(parseInt(num));
          displayValue.push(num);
          output.value = displayValue.join("");
          return;
        } else if (dotboolean === false) {
          dotboolean = true;
          equation.push(num);
          displayValue.push(num);
          output.value = displayValue.join("");
          return;
        } else {
          return;
        }
      };

      const updateOutputOp = (operator) => {
        console.log(operator, equation, "op");
        displayValue = [];
        dotboolean = false;
        if (operator === "=") {
          if (
            equation[equation.length - 1] === "+" ||
            equation[equation.length - 1] === "-" ||
            equation[equation.length - 1] === "*" ||
            equation[equation.length - 1] === "/"
          ) {
            equation.pop();
          } else {
            finalResult = eval(equation.join(""));
            output.value = finalResult;
            equation = [finalResult];
          }
        } else if (operator === "CE") {
          equation = [];
          output.value = 0;
          return;
        } else if (
          equation[equation.length - 1] === "+" ||
          equation[equation.length - 1] === "-" ||
          equation[equation.length - 1] === "*" ||
          equation[equation.length - 1] === "/"
        ) {
          return;
        } else {
          equation.push(operator);
          return;
        }
      };

      const buttonHandleClick = numbersArr.map((number) => {
        number.addEventListener("click", (e) => {
          updateOutputNum(e.target.value);
        });
      });

      const operatorHandleClick = operatorsArr.map((operator) => {
        operator.addEventListener("click", (e) => {
          updateOutputOp(e.target.textContent);
        });
      });
    </script>
  </body>
</html>
